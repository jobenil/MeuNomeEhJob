{"title":"Afinal, como se calcula os quartis?","markdown":{"yaml":{"title":"Afinal, como se calcula os quartis?","author":"Jobenil Júnior","date":"2025-05-20","categories":["r-code","alfabetização de dados","data literacy"]},"headingText":"Carregando pacotes","containsRefs":false,"markdown":"\n\nVocê sabia que exitem nove formas diferentes para se calcular os quartís no R?\n\nA tempos venho ensaiando escrever sobre esse assunto. Embora calcular essas estatísticas seja uma tarefa relativamente simples ao estudar a documentação do R, descobri que existem 9 maneiras diferentes para calcular esta estatística.\n\nO comando `quantile()` do pacote `{stats}` , um dos pacotes básicos do R, trás a seguinte definição:\n\n> *A função genérica quantil produz quantis amostrais correspondentes às probabilidades fornecidas. A menor observação corresponde a uma probabilidade de 0 e a maior, a uma probabilidade de 1.*\n\nNote que essa é na verdade a definição do que chamaríamos de percentil, pois pode-se escolher qualquer valor de probabilidade entre 0 e 1. Por exemplo se quisessemos obter os quartís $Q_1, Q_2 \\mbox{ e }Q_3$, empregaríamos no comando da função uma lista contendo os valores `c(0.25, 0.50, 0.75)`. O resultado seria correspondente aos valores da variável que são menores que 25%, 50% e 75% respectivamente. Estas são chamadas de estatísticas de ordem e ajuda o analista a entender como é o comportamento das sequencias numericas colecionadas. A depender desse comportamento pode-se verifica a adequabilidade do uso da mesma nos testes estatísticos ou ainda, de empregá-la em modelagem como análise de regressão por exemplo. Bem o que tudo isso tem a ver com nossa discussão? Existe um parâmetro que pode ser modificado dentro da função que permite escolher qual método de cálculo dessas estatísticas se quer usar. Em geral, nos cursos de Estatística Básica, são apresentadas uma ou duas formas para realizar esse cálculo - **variáveis discretas** ou **contínuas** - mas nove maneiras diferentes parece ser um exagero, não é mesmo? Uma das preocupações dos Estatísticos é que as **estatísticas** (resumos amostrais) possuam algumas propriedades específicas para a as mesma seja considerada como boa representante daquele **parâmetro** (resultado se tívessemos acesso aos dados de toda a população). Uma dessas propriedades é o seu **viés**, ou seja, a diferença da mesma em relação ao que deveria ser. No basilar [artigo](https://www.jstor.org/stable/2684934) de **Rob J. Hyndman** e **Yanan Fan** encontramos uma extensiva análise sobre os nove algoritmos utilizados na criação da função `quantile()`. Nele, os leitores mais técnicos, podem encontrar maiores detalhes sobre quem desenvolveu cada um e os motivos que os originaram. Uma discussão bem completa também poderá ser encontrada no [Wikipedia](https://en.wikipedia.org/wiki/Quantile). Para ilustrar como isso pode afetar os resultados na análise descritiva das variáveis elaboramos o código abaixo com duas simulações de variáveis - uma com distribuição normal e outra assimétrica e os efeitos de cada um dos algoritmos na computação dos percentis.\n\n```{r warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(dplyr)\n\n# Gerando os dados\nset.seed(123)\nx <- rnorm(1001, 15, 2.5)\ny <- rgamma(1001, shape = 2, rate = 1)\n\n# Definindo os percentis e os rótulos\np <- c(1, 5, 10, 20, 30, 40, 50)/100\npercent_labels <- paste0(p * 100, \"%\")\n\n# Função para calcular quantis usando os 9 tipos - extraida da própria documentação\nquantAll <- function(x, prob, ...) {\n  t(vapply(1:9, function(typ) quantile(x, probs = prob, type = typ, ...),\n           numeric(length(prob))))\n}\n\n# Calculando quantis com os 9 tipos para cada variável\nqmat_x <- quantAll(x, p)\nqmat_y <- quantAll(y, p)\n\n# Organizando os dados\n\ndf_x <- as.data.frame(qmat_x)\ncolnames(df_x) <- percent_labels\ndf_x$Type <- factor(1:9)\n\ndf_y <- as.data.frame(qmat_y)\ncolnames(df_y) <- percent_labels\ndf_y$Type <- factor(1:9)\n\n\ndf_x_long <- pivot_longer(df_x, -Type, names_to = \"Percentil\", values_to = \"Quantile\")\n\ndf_y_long <- pivot_longer(df_y, -Type, names_to = \"Percentil\", values_to = \"Quantile\")\n\n\ndf_x_long$Percentil <- factor(df_x_long$Percentil, levels = percent_labels)\n\ndf_y_long$Percentil <- factor(df_y_long$Percentil, levels = percent_labels)\n\n# Gerando os gráficos\nggplot(df_x_long, aes(x = Percentil, y = Quantile, color = Type)) +\n  geom_point(position = position_dodge(width = 0.5), size = 1.5) +\n  labs(title = \"Comparação de Quantis por Tipo (1 a 9) - Normal\",\n       x = \"Percentil\",\n       y = \"Valor do Quantil\",\n       color = \"Tipo de Quantile\") +\n  theme_minimal(base_size = 14)\n\nggplot(df_y_long, aes(x = Percentil, y = Quantile, color = Type)) +\n  geom_point(position = position_dodge(width = 0.5), size = 1.5) +\n  labs(title = \"Comparação de Quantis por Tipo (1 a 9) - Assimétrica\",\n       x = \"Percentil\",\n       y = \"Valor do Quantil\",\n       color = \"Tipo de Quantile\") +\n  theme_minimal(base_size = 14)\n```\n\nNote que na simulação dos dados normais, as estimativas dos percentís 1%, 5% e 10% apresentaram maior diversidade de resultados para cada tipo de algoritmo utilizado. Já para os dados com assimetria para a direita essa diversidade torna-se imperceptível na representação gráfica.\n\nEspero que tenha gostado desse tipo de artigo. Pretendo trazer mais análises sobre os pacotes e funções do *R* e *Python* ao longo do tempo. Obrigado pelo interesse.\n\nEDA \\| TESTE T \\| ENQUETES \\| ANOVA \\| MODELOS DE REGRESSÃO \\| ANÁLISE FATORIAL \\| MODELAGEM DE EQUAÇÕES ESTRUTURAIS \\| TRI \\| RASCH MODELS \\| MACHINE LEARNING\n\n![](images/whatsapp_logo.png){width=\"20\" height=\"20\"} [**Prof. Jobenil Júnior**](https://wa.me/5562992138972)\n","srcMarkdownNoYaml":"\n\nVocê sabia que exitem nove formas diferentes para se calcular os quartís no R?\n\nA tempos venho ensaiando escrever sobre esse assunto. Embora calcular essas estatísticas seja uma tarefa relativamente simples ao estudar a documentação do R, descobri que existem 9 maneiras diferentes para calcular esta estatística.\n\nO comando `quantile()` do pacote `{stats}` , um dos pacotes básicos do R, trás a seguinte definição:\n\n> *A função genérica quantil produz quantis amostrais correspondentes às probabilidades fornecidas. A menor observação corresponde a uma probabilidade de 0 e a maior, a uma probabilidade de 1.*\n\nNote que essa é na verdade a definição do que chamaríamos de percentil, pois pode-se escolher qualquer valor de probabilidade entre 0 e 1. Por exemplo se quisessemos obter os quartís $Q_1, Q_2 \\mbox{ e }Q_3$, empregaríamos no comando da função uma lista contendo os valores `c(0.25, 0.50, 0.75)`. O resultado seria correspondente aos valores da variável que são menores que 25%, 50% e 75% respectivamente. Estas são chamadas de estatísticas de ordem e ajuda o analista a entender como é o comportamento das sequencias numericas colecionadas. A depender desse comportamento pode-se verifica a adequabilidade do uso da mesma nos testes estatísticos ou ainda, de empregá-la em modelagem como análise de regressão por exemplo. Bem o que tudo isso tem a ver com nossa discussão? Existe um parâmetro que pode ser modificado dentro da função que permite escolher qual método de cálculo dessas estatísticas se quer usar. Em geral, nos cursos de Estatística Básica, são apresentadas uma ou duas formas para realizar esse cálculo - **variáveis discretas** ou **contínuas** - mas nove maneiras diferentes parece ser um exagero, não é mesmo? Uma das preocupações dos Estatísticos é que as **estatísticas** (resumos amostrais) possuam algumas propriedades específicas para a as mesma seja considerada como boa representante daquele **parâmetro** (resultado se tívessemos acesso aos dados de toda a população). Uma dessas propriedades é o seu **viés**, ou seja, a diferença da mesma em relação ao que deveria ser. No basilar [artigo](https://www.jstor.org/stable/2684934) de **Rob J. Hyndman** e **Yanan Fan** encontramos uma extensiva análise sobre os nove algoritmos utilizados na criação da função `quantile()`. Nele, os leitores mais técnicos, podem encontrar maiores detalhes sobre quem desenvolveu cada um e os motivos que os originaram. Uma discussão bem completa também poderá ser encontrada no [Wikipedia](https://en.wikipedia.org/wiki/Quantile). Para ilustrar como isso pode afetar os resultados na análise descritiva das variáveis elaboramos o código abaixo com duas simulações de variáveis - uma com distribuição normal e outra assimétrica e os efeitos de cada um dos algoritmos na computação dos percentis.\n\n```{r warning=FALSE, message=FALSE}\n# Carregando pacotes\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(dplyr)\n\n# Gerando os dados\nset.seed(123)\nx <- rnorm(1001, 15, 2.5)\ny <- rgamma(1001, shape = 2, rate = 1)\n\n# Definindo os percentis e os rótulos\np <- c(1, 5, 10, 20, 30, 40, 50)/100\npercent_labels <- paste0(p * 100, \"%\")\n\n# Função para calcular quantis usando os 9 tipos - extraida da própria documentação\nquantAll <- function(x, prob, ...) {\n  t(vapply(1:9, function(typ) quantile(x, probs = prob, type = typ, ...),\n           numeric(length(prob))))\n}\n\n# Calculando quantis com os 9 tipos para cada variável\nqmat_x <- quantAll(x, p)\nqmat_y <- quantAll(y, p)\n\n# Organizando os dados\n\ndf_x <- as.data.frame(qmat_x)\ncolnames(df_x) <- percent_labels\ndf_x$Type <- factor(1:9)\n\ndf_y <- as.data.frame(qmat_y)\ncolnames(df_y) <- percent_labels\ndf_y$Type <- factor(1:9)\n\n\ndf_x_long <- pivot_longer(df_x, -Type, names_to = \"Percentil\", values_to = \"Quantile\")\n\ndf_y_long <- pivot_longer(df_y, -Type, names_to = \"Percentil\", values_to = \"Quantile\")\n\n\ndf_x_long$Percentil <- factor(df_x_long$Percentil, levels = percent_labels)\n\ndf_y_long$Percentil <- factor(df_y_long$Percentil, levels = percent_labels)\n\n# Gerando os gráficos\nggplot(df_x_long, aes(x = Percentil, y = Quantile, color = Type)) +\n  geom_point(position = position_dodge(width = 0.5), size = 1.5) +\n  labs(title = \"Comparação de Quantis por Tipo (1 a 9) - Normal\",\n       x = \"Percentil\",\n       y = \"Valor do Quantil\",\n       color = \"Tipo de Quantile\") +\n  theme_minimal(base_size = 14)\n\nggplot(df_y_long, aes(x = Percentil, y = Quantile, color = Type)) +\n  geom_point(position = position_dodge(width = 0.5), size = 1.5) +\n  labs(title = \"Comparação de Quantis por Tipo (1 a 9) - Assimétrica\",\n       x = \"Percentil\",\n       y = \"Valor do Quantil\",\n       color = \"Tipo de Quantile\") +\n  theme_minimal(base_size = 14)\n```\n\nNote que na simulação dos dados normais, as estimativas dos percentís 1%, 5% e 10% apresentaram maior diversidade de resultados para cada tipo de algoritmo utilizado. Já para os dados com assimetria para a direita essa diversidade torna-se imperceptível na representação gráfica.\n\nEspero que tenha gostado desse tipo de artigo. Pretendo trazer mais análises sobre os pacotes e funções do *R* e *Python* ao longo do tempo. Obrigado pelo interesse.\n\nEDA \\| TESTE T \\| ENQUETES \\| ANOVA \\| MODELOS DE REGRESSÃO \\| ANÁLISE FATORIAL \\| MODELAGEM DE EQUAÇÕES ESTRUTURAIS \\| TRI \\| RASCH MODELS \\| MACHINE LEARNING\n\n![](images/whatsapp_logo.png){width=\"20\" height=\"20\"} [**Prof. Jobenil Júnior**](https://wa.me/5562992138972)\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","editor":"visual","theme":"cosmo","title-block-banner":true,"title":"Afinal, como se calcula os quartis?","author":"Jobenil Júnior","date":"2025-05-20","categories":["r-code","alfabetização de dados","data literacy"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}